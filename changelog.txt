handling for invalid keywords + rule priority fix + better keyword management